package parsebindbinary

import (
	"encoding/json"
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/taosdata/taosadapter/v3/driver/common"
)

func TestParseStmt2BindV(t *testing.T) {
	type args struct {
		bs []byte
	}
	tests := []struct {
		name    string
		args    args
		want    *Stmt2BindV
		wantErr bool
	}{
		{
			name: "table names only",
			args: args{
				bs: []byte{
					// total Length
					0x2f, 0x00, 0x00, 0x00,
					// tableCount
					0x03, 0x00, 0x00, 0x00,
					// TagCount
					0x00, 0x00, 0x00, 0x00,
					// ColCount
					0x00, 0x00, 0x00, 0x00,
					// TableNamesOffset
					0x1c, 0x00, 0x00, 0x00,
					// TagsOffset
					0x00, 0x00, 0x00, 0x00,
					// ColOffset
					0x00, 0x00, 0x00, 0x00,
					// table names
					// TableNameLength
					0x06, 0x00,
					0x01, 0x00,
					0x06, 0x00,
					// test1
					0x74, 0x65, 0x73, 0x74, 0x31, 0x00,
					// nil
					0x00,
					// test2
					0x74, 0x65, 0x73, 0x74, 0x32, 0x00,
				},
			},
			want: &Stmt2BindV{
				Count:      3,
				TableNames: []string{"test1", "", "test2"},
				Tags:       nil,
				Cols:       nil,
			},
			wantErr: false,
		},
		{
			name: "SetTableNameAndTags",
			args: args{
				bs: []byte{
					// total Length
					0x8a, 0x04, 0x00, 0x00,
					// tableCount
					0x03, 0x00, 0x00, 0x00,
					// TagCount
					0x10, 0x00, 0x00, 0x00,
					// ColCount
					0x00, 0x00, 0x00, 0x00,
					// TableNamesOffset
					0x1c, 0x00, 0x00, 0x00,
					// TagsOffset
					0x36, 0x00, 0x00, 0x00,
					// ColOffset
					0x00, 0x00, 0x00, 0x00,
					// table names
					// TableNameLength
					0x06, 0x00,
					0x08, 0x00,
					0x06, 0x00,
					// test1
					0x74, 0x65, 0x73, 0x74, 0x31, 0x00,
					// testnil
					0x74, 0x65, 0x73, 0x74, 0x6e, 0x69, 0x6c, 0x00,
					// test2
					0x74, 0x65, 0x73, 0x74, 0x32, 0x00,

					// tags

					// tagsDataLength
					// table1 DataLength
					0x8c, 0x01, 0x00, 0x00,
					// table2 DataLength
					0x30, 0x01, 0x00, 0x00,
					// table3 DataLength
					0x8c, 0x01, 0x00, 0x00,

					// tagsData
					// table1 tags
					// tag1 timestamp
					// totalLength
					0x1a, 0x00, 0x00, 0x00,

					// type
					0x09, 0x00, 0x00, 0x00,

					// num
					0x01, 0x00, 0x00, 0x00,

					// isnull
					0x00,

					// haveLength
					0x00,

					//buffer length
					0x08, 0x00, 0x00, 0x00,

					// buffer
					0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,

					// tag2 bool
					0x13, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,

					// tag3 tinyint
					0x13, 0x00, 0x00, 0x00,
					0x02, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,

					// tag4 smallint
					0x14, 0x00, 0x00, 0x00,
					0x03, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x02, 0x00, 0x00, 0x00,
					0x02, 0x00,

					// tag5 int
					0x16, 0x00, 0x00, 0x00,
					0x04, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x04, 0x00, 0x00, 0x00,
					0x03, 0x00, 0x00, 0x00,

					// tag6 bigint
					0x1a, 0x00, 0x00, 0x00,
					0x05, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x08, 0x00, 0x00, 0x00,
					0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

					// tag7 float
					0x16, 0x00, 0x00, 0x00,
					0x06, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x04, 0x00, 0x00, 0x00,
					0x00, 0x00, 0xb0, 0x40,

					// tag8 double
					0x1a, 0x00, 0x00, 0x00,
					0x07, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x08, 0x00, 0x00, 0x00,
					0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x1a, 0x40,

					// tag9 utinyint
					0x13, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x01, 0x00, 0x00, 0x00,
					0x07,

					// tag10 usmallint
					0x14, 0x00, 0x00, 0x00,
					0x0c, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x02, 0x00, 0x00, 0x00,
					0x08, 0x00,

					// tag11 uint
					0x16, 0x00, 0x00, 0x00,
					0x0d, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x04, 0x00, 0x00, 0x00,
					0x09, 0x00, 0x00, 0x00,

					// tag12 ubigint
					0x1a, 0x00, 0x00, 0x00,
					0x0e, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x08, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

					// tag13 binary
					0x1c, 0x00, 0x00, 0x00,
					0x08, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					// length
					0x06, 0x00, 0x00, 0x00,
					// buffer length
					0x06, 0x00, 0x00, 0x00,
					//buffer
					0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,

					// tag14 nchar
					0x1b, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					0x05, 0x00, 0x00, 0x00,
					0x05, 0x00, 0x00, 0x00,
					0x6e, 0x63, 0x68, 0x61, 0x72,

					// tag15 geometry
					0x2b, 0x00, 0x00, 0x00,
					0x14, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					0x15, 0x00, 0x00, 0x00,
					0x15, 0x00, 0x00, 0x00,
					0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40,

					// tag16 varbinary
					0x1f, 0x00, 0x00, 0x00,
					0x10, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					0x09, 0x00, 0x00, 0x00,
					0x09, 0x00, 0x00, 0x00,
					0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,

					// table 2 tags
					// tag1 timestamp nil
					// TotalLength
					0x12, 0x00, 0x00, 0x00,
					// type
					0x09, 0x00, 0x00, 0x00,
					// num
					0x01, 0x00, 0x00, 0x00,
					// isnull
					0x01,
					// haveLength
					0x00,
					// buffer length
					0x00, 0x00, 0x00, 0x00,

					// tag2 bool nil
					0x12, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag3 tinyint nil
					0x12, 0x00, 0x00, 0x00,
					0x02, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag4 smallint nil
					0x12, 0x00, 0x00, 0x00,
					0x03, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag5 int nil
					0x12, 0x00, 0x00, 0x00,
					0x04, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					//  tag6 bigint nil
					0x12, 0x00, 0x00, 0x00,
					0x05, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag7 float nil
					0x12, 0x00, 0x00, 0x00,
					0x06, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag8 double nil
					0x12, 0x00, 0x00, 0x00,
					0x07, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag9 utinyint nil
					0x12, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag10 usmallint nil
					0x12, 0x00, 0x00, 0x00,
					0x0c, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag11 uint nil
					0x12, 0x00, 0x00, 0x00,
					0x0d, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag12 ubigint nil
					0x12, 0x00, 0x00, 0x00,
					0x0e, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag13 binary nil
					0x16, 0x00, 0x00, 0x00,
					0x08, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x01,
					0x00, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag14 nchar nil
					0x16, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x01,
					0x00, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag15 geometry nil
					0x16, 0x00, 0x00, 0x00,
					0x14, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x01,
					0x00, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,

					// tag16 varbinary nil
					0x16, 0x00, 0x00, 0x00,
					0x10, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,
					0x01,
					0x00, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,

					// table 3 tags
					// tag1 timestamp
					0x1a, 0x00, 0x00, 0x00,
					0x09, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x08, 0x00, 0x00, 0x00,
					0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,

					// tag2 bool
					0x13, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,

					// tag3 tinyint
					0x13, 0x00, 0x00, 0x00,
					0x02, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x01, 0x00, 0x00, 0x00,
					0x01,

					// tag4 smallint
					0x14, 0x00, 0x00, 0x00,
					0x03, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x02, 0x00, 0x00, 0x00,
					0x02, 0x00,

					// tag5 int
					0x16, 0x00, 0x00, 0x00,
					0x04, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x04, 0x00, 0x00, 0x00,
					0x03, 0x00, 0x00, 0x00,

					// tag6 bigint
					0x1a, 0x00, 0x00, 0x00,
					0x05, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x08, 0x00, 0x00, 0x00,
					0x04, 0x00, 0x00, 0x00,

					// tag7 float
					0x00, 0x00, 0x00, 0x00,
					0x16, 0x00, 0x00, 0x00,
					0x06, 0x00, 0x00, 0x00,
					0x01,
					0x00,
					0x00, 0x00, 0x00, 0x00,
					0x04, 0x00, 0x00, 0x00,
					0x00, 0x00, 0xb0, 0x40,

					// tag8 double
					0x1a, 0x00, 0x00, 0x00,
					0x07, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x08, 0x00, 0x00, 0x00,
					0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x1a, 0x40,

					// tag9 utinyint
					0x13, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x01, 0x00, 0x00, 0x00,
					0x07,

					// tag10 usmallint
					0x14, 0x00, 0x00, 0x00,
					0x0c, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x02, 0x00, 0x00, 0x00,
					0x08, 0x00,

					// tag11 uint
					0x16, 0x00, 0x00, 0x00,
					0x0d, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x04, 0x00, 0x00, 0x00,
					0x09, 0x00, 0x00, 0x00,

					// tag12 ubigint
					0x1a, 0x00, 0x00, 0x00,
					0x0e, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x00,
					0x08, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

					// tag13 binary
					0x1c, 0x00, 0x00, 0x00,
					0x08, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					0x06, 0x00, 0x00, 0x00,
					0x06, 0x00, 0x00, 0x00,
					0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,

					// tag14 nchar
					0x1b, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					0x05, 0x00, 0x00, 0x00,
					0x05, 0x00, 0x00, 0x00,
					0x6e, 0x63, 0x68, 0x61, 0x72,

					// tag15 geometry
					0x2b, 0x00, 0x00, 0x00,
					0x14, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					0x15, 0x00, 0x00, 0x00,
					0x15, 0x00, 0x00, 0x00,
					0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40,

					// tag16 varbinary
					0x1f, 0x00, 0x00, 0x00,
					0x10, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00, 0x00,
					0x00,
					0x01,
					0x09, 0x00, 0x00, 0x00,
					0x09, 0x00, 0x00, 0x00,
					0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,
				},
			},
			want: &Stmt2BindV{
				Count:      3,
				TableNames: []string{"test1", "testnil", "test2"},
				Tags: [][]*Bind{
					{
						{
							Type: common.TSDB_DATA_TYPE_TIMESTAMP,
							Data: []byte(`[1726803356466]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BOOL,
							Data: []byte(`[true]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_TINYINT,
							Data: []byte(`[1]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_SMALLINT,
							Data: []byte(`[2]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_INT,
							Data: []byte(`[3]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BIGINT,
							Data: []byte(`[4]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_FLOAT,
							Data: []byte(`[5.5]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DOUBLE,
							Data: []byte(`[6.6]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UTINYINT,
							Data: []byte(`[7]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_USMALLINT,
							Data: []byte(`[8]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UINT,
							Data: []byte(`[9]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UBIGINT,
							Data: []byte(`[10]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BINARY,
							Data: []byte(`["binary"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_NCHAR,
							Data: []byte(`["nchar"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_GEOMETRY,
							Data: []byte(`["010100000000000000000059400000000000005940"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_VARBINARY,
							Data: []byte(`["76617262696e617279"]`),
						},
					},
					{
						{
							Type: common.TSDB_DATA_TYPE_TIMESTAMP,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_BOOL,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_TINYINT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_SMALLINT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_INT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_BIGINT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_FLOAT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_DOUBLE,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_UTINYINT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_USMALLINT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_UINT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_UBIGINT,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_BINARY,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_NCHAR,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_GEOMETRY,
							Data: nil,
						},
						{
							Type: common.TSDB_DATA_TYPE_VARBINARY,
							Data: nil,
						},
					},
					{
						{
							Type: common.TSDB_DATA_TYPE_TIMESTAMP,
							Data: []byte(`[1726803356466]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BOOL,
							Data: []byte(`[true]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_TINYINT,
							Data: []byte(`[1]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_SMALLINT,
							Data: []byte(`[2]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_INT,
							Data: []byte(`[3]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BIGINT,
							Data: []byte(`[4]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_FLOAT,
							Data: []byte(`[5.5]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DOUBLE,
							Data: []byte(`[6.6]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UTINYINT,
							Data: []byte(`[7]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_USMALLINT,
							Data: []byte(`[8]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UINT,
							Data: []byte(`[9]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UBIGINT,
							Data: []byte(`[10]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BINARY,
							Data: []byte(`["binary"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_NCHAR,
							Data: []byte(`["nchar"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_GEOMETRY,
							Data: []byte(`["010100000000000000000059400000000000005940"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_VARBINARY,
							Data: []byte(`["76617262696e617279"]`),
						},
					},
				},
				Cols: nil,
			},
			wantErr: false,
		},
		{
			name: "AllData",
			args: args{
				bs: []byte{
					// total Length
					0x32, 0x05, 0x00, 0x00,
					// tableCount
					0x01, 0x00, 0x00, 0x00,
					// TagCount
					0x13, 0x00, 0x00, 0x00,
					// ColCount
					0x13, 0x00, 0x00, 0x00,
					// TableNamesOffset
					0x1c, 0x00, 0x00, 0x00,
					// TagsOffset
					0x24, 0x00, 0x00, 0x00,
					// ColOffset
					0x1b, 0x02, 0x00, 0x00,
					// table names
					// table name length
					0x06, 0x00,
					// table name buffer
					0x74, 0x65, 0x73, 0x74, 0x31, 0x00,

					// tags
					// table length
					0xf3, 0x01, 0x00, 0x00,
					//table 0 tags
					//tag 0
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type
					0x09, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x08, 0x00, 0x00, 0x00,
					0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,

					//tag 1
					//total length
					0x13, 0x00, 0x00, 0x00,
					//type
					0x01, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x01, 0x00, 0x00, 0x00,
					0x01,

					//tag 2
					//total length
					0x13, 0x00, 0x00, 0x00,
					//type
					0x02, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x01, 0x00, 0x00, 0x00,
					0x01,

					//tag 3
					//total length
					0x14, 0x00, 0x00, 0x00,
					//type
					0x03, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x02, 0x00, 0x00, 0x00,
					0x02, 0x00,

					//tag 4
					//total length
					0x16, 0x00, 0x00, 0x00,
					//type
					0x04, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x04, 0x00, 0x00, 0x00,
					0x03, 0x00, 0x00, 0x00,

					//tag 5
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type
					0x05, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x08, 0x00, 0x00, 0x00,
					0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

					//tag 6
					//total length
					0x16, 0x00, 0x00, 0x00,
					//type
					0x06, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x04, 0x00, 0x00, 0x00,
					0x00, 0x00, 0xb0, 0x40,

					//tag 7
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type
					0x07, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x08, 0x00, 0x00, 0x00,
					0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x1a, 0x40,

					//tag 8
					//total length
					0x13, 0x00, 0x00, 0x00,
					//type
					0x0b, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x01, 0x00, 0x00, 0x00,
					0x07,

					//tag 9
					//total length
					0x14, 0x00, 0x00, 0x00,
					//type
					0x0c, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x02, 0x00, 0x00, 0x00,
					0x08, 0x00,

					//tag 10
					//total length
					0x16, 0x00, 0x00, 0x00,
					//type
					0x0d, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x04, 0x00, 0x00, 0x00,
					0x09, 0x00, 0x00, 0x00,

					//tag 11
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type
					0x0e, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x08, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

					//tag 12
					//total length
					0x1c, 0x00, 0x00, 0x00,
					//type
					0x08, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x01,
					// length
					0x06, 0x00, 0x00, 0x00,
					// buffer length
					0x06, 0x00, 0x00, 0x00,
					0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,

					//tag 13
					//total length
					0x1b, 0x00, 0x00, 0x00,
					//type
					0x0a, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x01,
					// length
					0x05, 0x00, 0x00, 0x00,
					// buffer length
					0x05, 0x00, 0x00, 0x00,
					0x6e, 0x63, 0x68, 0x61, 0x72,

					//tag 14
					//total length
					0x2b, 0x00, 0x00, 0x00,
					//type
					0x14, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x01,
					// length
					0x15, 0x00, 0x00, 0x00,
					// buffer length
					0x15, 0x00, 0x00, 0x00,
					0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40,

					//tag 15
					//total length
					0x1f, 0x00, 0x00, 0x00,
					//type
					0x10, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x01,
					// length
					0x09, 0x00, 0x00, 0x00,
					// buffer length
					0x09, 0x00, 0x00, 0x00,
					0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,

					//tag 16
					//total length
					0x20, 0x00, 0x00, 0x00,
					//type
					0x11, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x01,
					// length
					0x0a, 0x00, 0x00, 0x00,
					// buffer length
					0x0a, 0x00, 0x00, 0x00,
					0x31, 0x32, 0x33, 0x34, 0x35, 0x2e, 0x36, 0x37, 0x38, 0x39,

					//tag 17
					//total length
					0x20, 0x00, 0x00, 0x00,
					//type
					0x15, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x01,
					// length
					0x0a, 0x00, 0x00, 0x00,
					// buffer length
					0x0a, 0x00, 0x00, 0x00,
					0x39, 0x38, 0x37, 0x36, 0x35, 0x2e, 0x34, 0x33, 0x32, 0x31,

					//tag 18
					//total length
					0x27, 0x00, 0x00, 0x00,
					//type
					0x12, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x01,
					// length
					0x11, 0x00, 0x00, 0x00,
					// buffer length
					0x11, 0x00, 0x00, 0x00,
					0x74, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x62, 0x6c, 0x6f, 0x62, 0x20, 0x64, 0x61, 0x74, 0x61,

					// cols
					// col length
					0x13, 0x03, 0x00, 0x00,
					//table 0 cols
					//col 0
					//total length
					0x2c, 0x00, 0x00, 0x00,
					//type
					0x09, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x00,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x18, 0x00, 0x00, 0x00,
					0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00, 0x1a, 0x2f, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00, 0x02, 0x33, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,

					//col 1
					//total length
					0x17, 0x00, 0x00, 0x00,
					//type
					0x01, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x03, 0x00, 0x00, 0x00,
					0x01, 0x00, 0x00,

					//col 2
					//total length
					0x17, 0x00, 0x00, 0x00,
					//type
					0x02, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x03, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x0c,

					//col 3
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type
					0x03, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x06, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00, 0x0c, 0x00,

					//col 4
					//total length
					0x20, 0x00, 0x00, 0x00,
					//type
					0x04, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x0c, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00,

					//col 5
					//total length
					0x2c, 0x00, 0x00, 0x00,
					//type
					0x05, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x18, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

					//col 6
					//total length
					0x20, 0x00, 0x00, 0x00,
					//type
					0x06, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x0c, 0x00, 0x00, 0x00,
					0x33, 0x33, 0x33, 0x41, 0x00, 0x00, 0x00, 0x00, 0x33, 0x33, 0x43, 0x41,

					//col 7
					//total length
					0x2c, 0x00, 0x00, 0x00,
					//type
					0x07, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x18, 0x00, 0x00, 0x00,
					0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x26, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x28, 0x40,

					//col 8
					//total length
					0x17, 0x00, 0x00, 0x00,
					//type
					0x0b, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x03, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x0c,

					//col 9
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type
					0x0c, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x06, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00, 0x0c, 0x00,

					//col 10
					//total length
					0x20, 0x00, 0x00, 0x00,
					//type
					0x0d, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x0c, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00,

					//col 11
					//total length
					0x2c, 0x00, 0x00, 0x00,
					//type
					0x0e, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x18, 0x00, 0x00, 0x00,
					0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

					//col 12
					//total length
					0x2e, 0x00, 0x00, 0x00,
					//type
					0x08, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x01,
					// length
					0x07, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,
					0x07, 0x00, 0x00, 0x00,
					// buffer length
					0x0e, 0x00, 0x00, 0x00,
					0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x31, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x32,

					//col 13
					//total length
					0x2c, 0x00, 0x00, 0x00,
					//type
					0x0a, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x01,
					// length
					0x06, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,
					0x06, 0x00, 0x00, 0x00,
					// buffer length
					0x0c, 0x00, 0x00, 0x00,
					0x6e, 0x63, 0x68, 0x61, 0x72, 0x31, 0x6e, 0x63, 0x68, 0x61, 0x72, 0x32,

					//col 14
					//total length
					0x4a, 0x00, 0x00, 0x00,
					//type
					0x14, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x01,
					// length
					0x15, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,
					0x15, 0x00, 0x00, 0x00,
					// buffer length
					0x2a, 0x00, 0x00, 0x00,
					0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40,

					//col 15
					//total length
					0x34, 0x00, 0x00, 0x00,
					//type
					0x10, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x01,
					// length
					0x0a, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00,
					// buffer length
					0x14, 0x00, 0x00, 0x00,
					0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x31, 0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x32,

					//col 16
					//total length
					0x34, 0x00, 0x00, 0x00,
					//type
					0x11, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x01,
					// length
					0x0a, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00,
					// buffer length
					0x14, 0x00, 0x00, 0x00,
					0x31, 0x32, 0x33, 0x34, 0x35, 0x2e, 0x36, 0x37, 0x38, 0x39, 0x32, 0x32, 0x33, 0x34, 0x35, 0x2e, 0x36, 0x37, 0x38, 0x39,

					//col 17
					//total length
					0x34, 0x00, 0x00, 0x00,
					//type
					0x15, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x01,
					// length
					0x0a, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,
					0x0a, 0x00, 0x00, 0x00,
					// buffer length
					0x14, 0x00, 0x00, 0x00,
					0x39, 0x38, 0x37, 0x36, 0x35, 0x2e, 0x34, 0x33, 0x32, 0x31, 0x38, 0x38, 0x37, 0x36, 0x35, 0x2e, 0x34, 0x33, 0x32, 0x31,

					//col 18
					//total length
					0x4a, 0x00, 0x00, 0x00,
					//type
					0x12, 0x00, 0x00, 0x00,
					//num
					0x03, 0x00, 0x00, 0x00,
					//is null
					0x00,
					0x01,
					0x00,
					// haveLength
					0x01,
					// length
					0x11, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00,
					0x19, 0x00, 0x00, 0x00,
					// buffer length
					0x2a, 0x00, 0x00, 0x00,
					0x74, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x62, 0x6c, 0x6f, 0x62, 0x20, 0x64, 0x61, 0x74, 0x61, 0x74, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x61, 0x6e, 0x6f, 0x74, 0x68, 0x65, 0x72, 0x20, 0x62, 0x6c, 0x6f, 0x62, 0x20, 0x64, 0x61, 0x74, 0x61,
				},
			},
			want: &Stmt2BindV{
				Count:      1,
				TableNames: []string{"test1"},
				Tags: [][]*Bind{
					{
						{
							Type: common.TSDB_DATA_TYPE_TIMESTAMP,
							Data: []byte(`[1726803356466]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BOOL,
							Data: []byte(`[true]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_TINYINT,
							Data: []byte(`[1]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_SMALLINT,
							Data: []byte(`[2]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_INT,
							Data: []byte(`[3]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BIGINT,
							Data: []byte(`[4]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_FLOAT,
							Data: []byte(`[5.5]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DOUBLE,
							Data: []byte(`[6.6]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UTINYINT,
							Data: []byte(`[7]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_USMALLINT,
							Data: []byte(`[8]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UINT,
							Data: []byte(`[9]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UBIGINT,
							Data: []byte(`[10]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BINARY,
							Data: []byte(`["binary"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_NCHAR,
							Data: []byte(`["nchar"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_GEOMETRY,
							Data: []byte(`["010100000000000000000059400000000000005940"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_VARBINARY,
							Data: []byte(`["76617262696e617279"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DECIMAL,
							Data: []byte(`["12345.6789"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DECIMAL64,
							Data: []byte(`["98765.4321"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BLOB,
							Data: []byte(`["7468697320697320626c6f622064617461"]`),
						},
					},
				},
				Cols: [][]*Bind{
					{
						{
							Type: common.TSDB_DATA_TYPE_TIMESTAMP,
							Data: []byte(`[1726803356466,1726803357466,1726803358466]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BOOL,
							Data: []byte(`[true,null,false]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_TINYINT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_SMALLINT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_INT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BIGINT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_FLOAT,
							Data: []byte(`[11.2,null,12.2]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DOUBLE,
							Data: []byte(`[11.2,null,12.2]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UTINYINT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_USMALLINT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UINT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_UBIGINT,
							Data: []byte(`[11,null,12]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BINARY,
							Data: []byte(`["binary1",null,"binary2"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_NCHAR,
							Data: []byte(`["nchar1",null,"nchar2"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_GEOMETRY,
							Data: []byte(`["010100000000000000000059400000000000005940",null,"010100000000000000000059400000000000005940"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_VARBINARY,
							Data: []byte(`["76617262696e61727931",null,"76617262696e61727932"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DECIMAL,
							Data: []byte(`["12345.6789",null,"22345.6789"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_DECIMAL64,
							Data: []byte(`["98765.4321",null,"88765.4321"]`),
						},
						{
							Type: common.TSDB_DATA_TYPE_BLOB,
							Data: []byte(`["7468697320697320626c6f622064617461",null,"7468697320697320616e6f7468657220626c6f622064617461"]`),
						},
					},
				},
			},
		},
		{
			name: "wrong tag type",
			args: args{
				bs: []byte{
					// total Length
					0x42, 0x00, 0x00, 0x00,
					// tableCount
					0x01, 0x00, 0x00, 0x00,
					// TagCount
					0x01, 0x00, 0x00, 0x00,
					// ColCount
					0x00, 0x00, 0x00, 0x00,
					// TableNamesOffset
					0x1c, 0x00, 0x00, 0x00,
					// TagsOffset
					0x24, 0x00, 0x00, 0x00,
					// ColOffset
					0x00, 0x00, 0x00, 0x00,
					// table names
					// table name length
					0x06, 0x00,
					// table name buffer
					0x74, 0x65, 0x73, 0x74, 0x31, 0x00,

					// tags
					// table length
					0x1a, 0x00, 0x00, 0x00,
					//table 0 tags
					//tag 0
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type wrong!!
					0xff, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x08, 0x00, 0x00, 0x00,
					0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,
				},
			},
			wantErr: true,
		},
		{
			name: "wrong col type",
			args: args{
				bs: []byte{
					// total Length
					0x3a, 0x00, 0x00, 0x00,
					// tableCount
					0x01, 0x00, 0x00, 0x00,
					// TagCount
					0x00, 0x00, 0x00, 0x00,
					// ColCount
					0x01, 0x00, 0x00, 0x00,
					// TableNamesOffset
					0x00, 0x00, 0x00, 0x00,
					// TagsOffset
					0x00, 0x00, 0x00, 0x00,
					// ColOffset
					0x1c, 0x00, 0x00, 0x00,
					// cols
					// col length
					0x1a, 0x00, 0x00, 0x00,
					//table 0 cols
					//col 0
					//total length
					0x1a, 0x00, 0x00, 0x00,
					//type wrong
					0xff, 0x00, 0x00, 0x00,
					//num
					0x01, 0x00, 0x00, 0x00,
					//is null
					0x00,
					// haveLength
					0x00,
					// buffer length
					0x08, 0x00, 0x00, 0x00,
					0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,
				},
			},
			wantErr: true,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			got, err := ParseStmt2BindV(tt.args.bs)
			if (err != nil) != tt.wantErr {
				t.Errorf("ParseStmt2BindV() error = %v, wantErr %v", err, tt.wantErr)
				return
			}
			assert.Equal(t, tt.want, got)
			bs, err := json.Marshal(got)
			assert.NoError(t, err)
			t.Logf("bindv json:%s", string(bs))
		})
	}
}

func BenchmarkParse(b *testing.B) {
	bs := []byte{
		// TotalLength
		0x19, 0x04, 0x00, 0x00,
		// tableCount
		0x01, 0x00, 0x00, 0x00,
		// TagCount
		0x10, 0x00, 0x00, 0x00,
		// ColCount
		0x10, 0x00, 0x00, 0x00,
		// TableNamesOffset
		0x1c, 0x00, 0x00, 0x00,
		// TagsOffset
		0x24, 0x00, 0x00, 0x00,
		// ColsOffset
		0xb4, 0x01, 0x00, 0x00,

		// TableNameLength
		0x06, 0x00,
		// TableNameBuffer
		0x74, 0x65, 0x73, 0x74, 0x31, 0x00,

		// TagsDataLength
		0x8c, 0x01, 0x00, 0x00,

		// TagsBuffer

		// tag1 timestamp
		// TotalLength
		0x1a, 0x00, 0x00, 0x00,
		// type
		0x09, 0x00, 0x00, 0x00,
		// num
		0x01, 0x00, 0x00, 0x00,
		// isnull
		0x00,
		// haveLength
		0x00,
		// buffer length
		0x08, 0x00, 0x00, 0x00,
		// buffer
		0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,

		// tag2 bool
		0x13, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x01, 0x00, 0x00, 0x00,
		0x01,

		// tag3 tinyint
		0x13, 0x00, 0x00, 0x00,
		0x02, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x01, 0x00, 0x00, 0x00,
		0x01,

		// tag4 smallint
		0x14, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x02, 0x00, 0x00, 0x00,
		0x02, 0x00,

		// tag5 int
		0x16, 0x00, 0x00, 0x00,
		0x04, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x04, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,

		// tag6 bigint
		0x1a, 0x00, 0x00, 0x00,
		0x05, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x08, 0x00, 0x00, 0x00,
		0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		// tag7 float
		0x16, 0x00, 0x00, 0x00,
		0x06, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x04, 0x00, 0x00, 0x00,
		0x00, 0x00, 0xb0, 0x40,

		// tag8 double
		0x1a, 0x00, 0x00, 0x00,
		0x07, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x08, 0x00, 0x00, 0x00,
		0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x1a, 0x40,

		// tag9 utinyint
		0x13, 0x00, 0x00, 0x00,
		0x0b, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x01, 0x00, 0x00, 0x00,
		0x07,

		// tag10 usmallint
		0x14, 0x00, 0x00, 0x00,
		0x0c, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x02, 0x00, 0x00, 0x00,
		0x08, 0x00,

		// tag11 uint
		0x16, 0x00, 0x00, 0x00,
		0x0d, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x04, 0x00, 0x00, 0x00,
		0x09, 0x00, 0x00, 0x00,

		// tag12 ubigint
		0x1a, 0x00, 0x00, 0x00,
		0x0e, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x00,
		0x08, 0x00, 0x00, 0x00,
		0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		// tag13 binary
		0x1c, 0x00, 0x00, 0x00,
		0x08, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		// haveLength
		0x01,
		// length
		0x06, 0x00, 0x00, 0x00,
		//buffer length
		0x06, 0x00, 0x00, 0x00,
		0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,

		// tag14 nchar
		0x1b, 0x00, 0x00, 0x00,
		0x0a, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x01,
		0x05, 0x00, 0x00, 0x00,
		0x05, 0x00, 0x00, 0x00,
		0x6e, 0x63, 0x68, 0x61, 0x72,

		// tag15 geometry
		0x2b, 0x00, 0x00, 0x00,
		0x14, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x01,
		0x15, 0x00, 0x00, 0x00,
		0x15, 0x00, 0x00, 0x00,
		0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40,

		// tag16 varbinary
		0x1f, 0x00, 0x00, 0x00,
		0x10, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00,
		0x01,
		0x09, 0x00, 0x00, 0x00,
		0x09, 0x00, 0x00, 0x00,
		0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79,

		// ColDataLength
		0x61, 0x02, 0x00, 0x00,

		// ColBuffer
		// col1 timestamp
		// TotalLength
		0x2c, 0x00, 0x00, 0x00,
		// Type
		0x09, 0x00, 0x00, 0x00,
		// Num
		0x03, 0x00, 0x00, 0x00,
		// IsNull
		0x00, 0x00, 0x00,
		//haveLength
		0x00,
		// BufferLength
		0x18, 0x00, 0x00, 0x00,
		// Data
		0x32, 0x2b, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,
		0x1a, 0x2f, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,
		0x02, 0x33, 0x80, 0x0d, 0x92, 0x01, 0x00, 0x00,

		// col2 bool
		0x17, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		// is null, row index 1 is null
		0x00, 0x01, 0x00,
		0x00,
		0x03, 0x00, 0x00, 0x00,

		// row0
		0x01,
		// row1
		0x00,
		// row2
		0x00,

		// col3 tinyint
		0x17, 0x00, 0x00, 0x00,
		0x02, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x03, 0x00, 0x00, 0x00,

		0x0b,
		0x00,
		0x0c,

		// col4 smallint
		0x1a, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x06, 0x00, 0x00, 0x00,

		0x0b, 0x00,
		0x00, 0x00,
		0x0c, 0x00,

		// col5 int
		0x20, 0x00, 0x00, 0x00,
		0x04, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x0c, 0x00, 0x00, 0x00,

		0x0b, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x0c, 0x00, 0x00, 0x00,

		// col6 bigint
		0x2c, 0x00, 0x00, 0x00,
		0x05, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x18, 0x00, 0x00, 0x00,

		0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		// col7 float
		0x20, 0x00, 0x00, 0x00,
		0x06, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x0c, 0x00, 0x00, 0x00,
		0x33, 0x33, 0x33, 0x41,
		0x00, 0x00, 0x00, 0x00,
		0x33, 0x33, 0x43, 0x41,

		// col8 double
		0x2c, 0x00, 0x00, 0x00,
		0x07, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x18, 0x00, 0x00, 0x00,

		0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x26, 0x40,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x28, 0x40,

		// col9 utinyint
		0x17, 0x00, 0x00, 0x00,
		0x0b, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x03, 0x00, 0x00, 0x00,

		0x0b,
		0x00,
		0x0c,

		// col10 usmallint
		0x1a, 0x00, 0x00, 0x00,
		0x0c, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x06, 0x00, 0x00, 0x00,

		0x0b, 0x00,
		0x00, 0x00,
		0x0c, 0x00,

		// col11 uint
		0x20, 0x00, 0x00, 0x00,
		0x0d, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x0c, 0x00, 0x00, 0x00,

		0x0b, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x0c, 0x00, 0x00, 0x00,

		// col12 ubigint
		0x2C, 0x00, 0x00, 0x00,
		0x0e, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x00,
		0x18, 0x00, 0x00, 0x00,

		0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		// col13 binary
		0x2e, 0x00, 0x00, 0x00,
		0x08, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		// have length
		0x01,
		// length
		0x07, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x07, 0x00, 0x00, 0x00,
		// buffer length
		0x0e, 0x00, 0x00, 0x00,
		// buffer
		0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x31,
		0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x32,

		// col14 nchar
		0x2c, 0x00, 0x00, 0x00,
		0x0a, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x01,
		// length
		0x06, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x06, 0x00, 0x00, 0x00,
		// buffer length
		0x0c, 0x00, 0x00, 0x00,
		// buffer
		0x6e, 0x63, 0x68, 0x61, 0x72, 0x31,
		0x6e, 0x63, 0x68, 0x61, 0x72, 0x32,

		// col15 geometry
		0x4a, 0x00, 0x00, 0x00,
		0x14, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x01,
		// length
		0x15, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x15, 0x00, 0x00, 0x00,
		// buffer length
		0x2a, 0x00, 0x00, 0x00,
		// buffer
		0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40,
		0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x40,

		// col16 varbinary
		0x34, 0x00, 0x00, 0x00,
		0x10, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00,
		0x01,
		// length
		0x0a, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x0a, 0x00, 0x00, 0x00,
		// buffer length
		0x14, 0x00, 0x00, 0x00,
		// buffer
		0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x31,
		0x76, 0x61, 0x72, 0x62, 0x69, 0x6e, 0x61, 0x72, 0x79, 0x32,
	}
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		_, err := ParseStmt2BindV(bs)
		if err != nil {
			b.Errorf("ParseStmt2BindV() error = %v", err)
		}
	}
}
